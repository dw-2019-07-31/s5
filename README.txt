1.はじめに
  【Pythonインストールについて】
    本ツールは、Pythonというプログラミング言語によって作成されています。
    よってツールを使用するには、Pythonのインストールが必須となります。
    下記手順に従い、ローカル環境にPythonのインストールをお願いします。

  【Oracle Clientについて】
    プログラムからLISの商品情報を見にいくために、「Oracle Client」が必要となります。
    「3.Oracleインストール状況の確認」手順を実施し、必要に応じてOracle Clientのインストールをお願いします。
    ※既にインストールされている場合はインストール作業は不要です。


2.インストーラーの準備
　2-1.以下フォルダーに格納されているインストーラ「python-3.6.4-amd64.exe」をデスクトップにコピーしてください。
      "Z:\open\ADIV\ICTG\90_インストーラー\13_Python"

  2-2.以下フォルダーに格納されている「client」フォルダーをデスクトップにコピーしてください。
      "Z:\open\ADIV\ICTG\90_インストーラー\96_OracleClient\Oracle12cClient_x64"


3.Oracleインストール状況の確認
  3-1.windowsボタンを押下します。

  3-2.「すべてのプログラム」をクリックします。
  
  3-3.「Oracle - OracleClient」と表記のあるプログラムが一覧にあるか確認してください。
      Oracle Clientがインストールされている場合は、「6.Pythonインストール」へ進んでください。
      Oracle Clientがインストールされていない場合は、「4.Oracle Clientインストール」へ進んでください。


4.Oracle Clientインストール
  ※インストール手順実施中に「Windowsセキュリティの重要な警告」が出たら「アクセスを許可する」をクリックしてください。

  4-1.項番2-1でコピーしたフォルダーを開き、「setup.exe」を右クリックで「管理者として実行」をクリックしてください。
      ※ユーザーアカウント制御の画面が表示されたら「はい」をクリックしてください。

  4-2.「管理者」を選択し、「次へ」をクリックしてください。

  4-3.「ソフトウェア更新のスキップ」が選択されていることを確認し、「次へ」をクリックしてください。

  4-4.「日本語」「英語」が選択されていることを確認し、「次へ」をクリックしてください。

  4-5.「windows組込みアカウントの使用」が選択されていることを確認し、「次へ」をクリックしてください。

  4-6.インストール場所の指定は初期値のまま、「次へ」をクリックしてください。

  4-7.サマリー画面が表示されたら、「インストール」をクリックしてください。

  4-8.「閉じる」をクリックしてください。

  4-9.再び「setup.exe」を右クリックで「管理者として実行」をクリックしてください。
      ※ユーザーアカウント制御の画面が表示されたら「はい」をクリックしてください。

  4-10.「カスタム」を選択し、「次へ」をクリックしてください。

  4-11.「ソフトウェア更新のスキップ」が選択されていることを確認し、「次へ」をクリックしてください。

  4-12.「日本語」「英語」が選択されていることを確認し、「次へ」をクリックしてください。

  4-13.「windows組込みアカウントの使用」が選択されていることを確認し、「次へ」をクリックしてください。

  4-14.「ソフトウェアの場所」を以下のパスに変更し、「次へ」をクリックしてください。
        "C:\app\client\ユーザー名\product\12.1.0\client_1"

  4-15.「Oracle ODBC Driver」を選択し、「次へ」をクリックしてください。

  4-16.サマリー画面が表示されたら、「インストール」をクリックしてください。

  4-17.「閉じる」をクリックしてください。


5.tnsnames.oraの格納
  5-1.以下の格納元に格納されている「tnsnames.ora」ファイルを格納先にコピーしてください。
      格納元："Z:\open\ADIV\ICTG\90_インストーラー\96_OracleClient"
      格納先："C:\app\client\%USERNAME%\product\12.1.0\client_1\network\admin"


6.Pythonインストール手順
  6-1.項番2-2コピーしたインストーラを右クリックし、「管理者として実行」をクリックしてください。
      ※ユーザーアカウント制御の画面が表示されたら「はい」をクリックしてください。

  6-2.セットアップ画面が開くので、「Add Python 3.6 to PATH」にチェックを入れて「Install Now」をクリックしてください。

  6-3.「Setup was successful」と表示されたら、「Close」をクリックしてください。

  6-4.「windows + R」を押下し、cmdと入力しコマンドプロンプトを起動してください。

  6-5.コマンドプロンプトに、以下のコマンドを入力しEnterを押下してください。
      コマンド：python -m pip install --upgrade pip

  6-6.コマンドプロンプトに、以下のコマンドを入力しEnterを押下してください。
      コマンド：pip install cx_Oracle

  6-7.コマンドプロンプトに、以下のコマンドを入力しEnterを押下してください。
      コマンド：pip install pysmb


7.事後作業
  7-1.デスクトップに保存した「python-3.6.4-amd64.exe」、「client」フォルダーを削除する。


8.ツールの使い方
  8-1.S5に登録したい商品を「DI,品番,画像枚数」の順で入力し、CSVファイルを作成する。
      ファイル名は「s5.csv」としてください。ヘッダーは不要です。
      例：品番「BGLL86355」の商品登録をしたい場合のCSV記入方法は「10790,BGLL86355,3」

  8-2.項番8-1で作成したCSVファイルをローカルのs5フォルダー直下に格納する。

  8-3.s5フォルダー直下の「execute.ps1」を右クリックし、「PowerShellで実行」を押下する。

  8-4.s5フォルダー直下に「test.csv」が作成されるので、内容をご確認の上S5にインポートしてください。


9.プログラムファイルのメンテナンス
  ※プログラムファイルの編集作業は必ず高梨さんが行ってください。

  〇ブランドのカナ名登録
    S5に登録したい商品のブランドが以下のリストにないとプログラムがエラーとなります。
    "Z:\open\ADIV\ICTG\01_システム、ツール\s5\etc\brand.json"
    登録したい商品のブランドが上のリストにない場合は、リストにブランドを追加してください。
    
  〇LISの商品情報から特定の文章や記号、文字を除外したい場合
    LISの商品情報から特定の文章や記号、文字を除外したい場合は、以下のリストを編集する必要があります。
    "Z:\open\ADIV\ICTG\01_システム、ツール\s5\etc\deletecharacter.json"
    文章を除外したい場合は、sentenceの中に
    記号や文字を除外したい場合は、symbolの中のリストに追加してください。
    
  〇JSONファイルとは
    JSONファイルについての記事になります。ご一読ください。
    http://www.trident-game.com/blog/2015/10/14/%E3%80%90%E8%BC%AA%E8%AC%9B%E3%80%91json%E3%81%AE%E6%9B%B8%E3%81%8D%E6%96%B9/
    

なにかご不明点等ありましたら、ICTG浦野または結城にご連絡ください。
